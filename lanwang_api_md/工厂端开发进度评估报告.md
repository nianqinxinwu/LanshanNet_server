# 《+1》居间交易平台 — 工厂端开发进度评估报告

> 评估时间：2026-02-10
> 需求依据：《+1》平台.xlsx、《+1》居间交易平台页面规划方案.docx

---

## 一、模块总览

| # | 功能模块 | 需求开发进度 |
|---|---------|:-----------:|
| 1 | 企业认证 | 5% |
| 2 | 居间人筛选 | 0% |
| 3 | 产品上架管理 | 5% |
| 4 | 订单处理（接单） | 5% |
| 5 | 竞标订单（报价） | 5% |
| 6 | 佣金锁定与放款 | 0% |
| 7 | 合同审核 | 0% |
| 8 | 发货管理 | 0% |
| 9 | 数据看板 | 0% |
| 10 | 积分与心愿 | 0% |
| 11 | 移动工作台 | 0% |
| 12 | 站内即时通讯（IM） | 0% |
| 13 | 消息通知与推送 | 0% |
| **综合** | | **约 2%** |

> **说明：** 工厂端目前仅有角色选择入口（`jj_start.vue` 中 roleType=2）和后端 `Factory` Model，尚未开发任何独立的工厂端页面和API控制器。以下评估基于需求文档列出各模块的预期功能和当前代码对应情况。

---

## 二、各模块详细评估

---

### 1. 企业认证

**需求描述：** 工厂提交营业执照（OCR识别）、产品检测报告（PDF）、国际贸易证书、欧盟认证等资质材料，平台审核通过后可上架产品。

| 类型 | 文件路径 | 状态 |
|------|---------|:----:|
| 前端页面 | 无（需新建 `fc_auth.vue`） | 未开发 |
| 后端控制器 | 无（需新建 `FcFactory.php`） | 未开发 |
| 数据库表 | `fa_jj_factory`（已存在，含 company_name/fulfill_rate 等基础字段） | 部分可用 |
| 数据库Model | `application/common/model/jj/Factory.php`（已存在） | 部分可用 |

**已完成：**
- `fa_jj_factory` 表已建立，含基本字段（company_name, province, industry, fulfill_rate, status）
- `Factory.php` Model 已存在，定义了状态常量（pending/normal/frozen）

**未完成：**
- 工厂端认证提交页面
- 营业执照OCR识别
- 检测报告PDF上传与管理
- 国际贸易证书、欧盟认证上传
- 工厂照片上传
- 审核状态展示（待审核/已入驻）
- 后端认证提交/查询接口

**进度：5%**

---

### 2. 居间人筛选

**需求描述：** 工厂可按"六边形身价评分 >= 80"等条件筛选居间人，查看居间人雷达图和历史成交记录。

| 类型 | 文件路径 | 状态 |
|------|---------|:----:|
| 前端页面 | 无（需新建 `fc_agent_list.vue`） | 未开发 |
| 后端控制器 | 无（需新建 `FcAgent.php`） | 未开发 |
| 数据库表 | `fa_jj_agent_profile`（已存在，含六维度评分） | 可复用 |

**已完成：**
- 居间人资料表已存在（含六维度评分字段）

**未完成：**
- 居间人列表/筛选页面
- 按评分、成交量等条件筛选
- 居间人雷达图展示
- 历史成交记录查看
- 后端筛选接口

**进度：0%**

---

### 3. 产品上架管理

**需求描述：** 工厂发布产品到平台商品池（产品名称、规格、工艺标准富文本、库存、佣金比例滑块、检测报告关联），支持上架/下架/可排产状态切换。

| 类型 | 文件路径 | 状态 |
|------|---------|:----:|
| 前端页面 | 无（需新建 `fc_product_list.vue`、`fc_product_edit.vue`） | 未开发 |
| 后端控制器 | 无（需新建 `FcProduct.php`，含 add/edit/list/on_shelf/off_shelf） | 未开发 |
| 数据库表 | `fa_jj_product`（已存在，含 name/price/stock/commission_rate/status 等字段） | 可复用 |
| 数据库Model | `application/common/model/jj/Product.php`（已存在，定义了 STATUS_ON/STATUS_OFF） | 可复用 |

**已完成：**
- `fa_jj_product` 表已建立，字段基本覆盖需求
- `Product.php` Model 已存在，含状态常量
- 居间人端已有产品列表/详情的读取接口（`JjProduct.php`），工厂端可参考

**未完成：**
- 产品新增/编辑表单页面（含富文本工艺标准编辑器）
- 产品列表管理页面
- 佣金比例滑块控件
- 检测报告PDF关联选择
- 上架/下架/可排产状态切换
- 产能佣金输入（工厂自估）
- 后端产品CRUD接口（新增/编辑/删除/状态切换）

**进度：5%**

---

### 4. 订单处理（接单）

**需求描述：** 工厂管理订单全生命周期：待确认 → 待缴保证金 → 待锁定佣金 → 待发货 → 已完成。包含确认接单、查看合同、确认发货、同意放款等操作。

| 类型 | 文件路径 | 状态 |
|------|---------|:----:|
| 前端页面 | 无（需新建 `fc_orders.vue`、`fc_order_detail.vue`） | 未开发 |
| 后端控制器 | 无（需新建 `FcOrder.php`，含 list/detail/confirm/ship/release_payment） | 未开发 |
| 数据库表 | `fa_jj_order`（已存在，9种状态已定义） | 可复用 |
| 数据库表 | `fa_jj_order_log`（已存在，状态变更日志） | 可复用 |

**已完成：**
- `fa_jj_order` 表已建立，完整的9状态机
- `Order.php` Model 已存在
- 居间人端订单接口（`JjOrder.php`）已实现 submit/detail/index 等方法

**未完成：**
- 工厂端订单列表页面（按状态Tab筛选）
- 工厂端订单详情页面
- 确认接单操作
- 锁定佣金操作（2小时内必须锁定，否则封禁1个月）
- 确认发货操作（填写物流信息）
- 同意放款操作（触发资金流转）
- 风险监控提醒（佣金未锁定倒计时）
- 后端工厂端订单接口

**进度：5%**

---

### 5. 竞标订单（报价）

**需求描述：** 工厂收到居间人发起的竞标邀请，查看需求信息和倒计时，提交报价（合同价、交货日期、佣金总额自动计算），72小时内可修改一次报价。

| 类型 | 文件路径 | 状态 |
|------|---------|:----:|
| 前端页面 | 无（需新建 `fc_bid_list.vue`、`fc_bid_quote.vue`） | 未开发 |
| 后端控制器 | 无（需新建 `FcBid.php`，含 invitation_list/detail/submit_quote/update_quote） | 未开发 |
| 数据库表 | `fa_jj_bid`（已存在） | 可复用 |
| 数据库表 | `fa_jj_bid_quote`（已存在，含 factory_id/contract_price/commission_amount/status） | 可复用 |

**已完成：**
- `fa_jj_bid` 和 `fa_jj_bid_quote` 表已建立
- `Bid.php` 和 `BidQuote.php` Model 已存在
- 居间人端已实现竞标发布和查看报价的接口

**未完成：**
- 竞标邀请列表页面（含倒计时）
- 报价提交表单（合同价/交货日期/备注）
- 佣金总额自动计算
- 72小时修改报价功能
- 报价历史/状态查看
- 后端工厂竞标接口

**进度：5%**

---

### 6. 佣金锁定与放款

**需求描述：** 居间人缴纳保证金后，工厂在2小时内必须将全额佣金锁定到平台托管账户B；交货验收后工厂点击"同意放款"触发资金自动分配（B → C+D+E → 居间人账户，A退还居间人）。

| 类型 | 文件路径 | 状态 |
|------|---------|:----:|
| 前端页面 | 无（需集成到 `fc_order_detail.vue`） | 未开发 |
| 后端控制器 | 无（需在 `FcOrder.php` 中实现 lock_commission/release_payment） | 未开发 |
| 数据库表 | `fa_jj_deposit`（已存在） | 可复用 |
| 数据库表 | `fa_jj_commission`（已存在） | 可复用 |

**已完成：**
- 保证金和佣金相关数据表已建立

**未完成：**
- 佣金锁定操作与接口
- 2小时锁定倒计时及风控处理
- 同意放款操作
- 五账户资金自动分配逻辑（A/B/C/D/E）
- 资金流转记录

**进度：0%**

---

### 7. 合同审核

**需求描述：** 工厂查看居间人上传的买卖合同和佣金合同，进行审核（通过/驳回），通过后进入履约倒计时，驳回需填写原因。

| 类型 | 文件路径 | 状态 |
|------|---------|:----:|
| 前端页面 | 无（需集成到 `fc_order_detail.vue`） | 未开发 |
| 后端控制器 | 无（需在 `FcOrder.php` 中实现 review_contract） | 未开发 |
| 数据库表 | `fa_jj_contract`（已存在，含 file_url/status） | 可复用 |

**已完成：**
- 合同数据表已建立

**未完成：**
- 合同PDF预览页面
- 合同审核操作（通过/驳回+原因）
- 审核通过后触发履约倒计时
- 后端合同审核接口

**进度：0%**

---

### 8. 发货管理

**需求描述：** 工厂查看居间人选择的物流方式，填写运输信息（物流公司、运单号），确认发货。工厂为执行角色，不可修改物流方式。

| 类型 | 文件路径 | 状态 |
|------|---------|:----:|
| 前端页面 | 无（需新建 `fc_shipment.vue` 或集成到订单详情） | 未开发 |
| 后端控制器 | 无（需在 `FcOrder.php` 中实现 confirm_shipment） | 未开发 |
| 数据库表 | `fa_jj_logistics`（已存在，含 logistics_type/status/timeline_json） | 可复用 |

**已完成：**
- 物流数据表已建立

**未完成：**
- 发货信息填写表单（物流公司、运单号）
- 发货确认操作
- 物流状态展示
- 后端发货接口

**进度：0%**

---

### 9. 数据看板

**需求描述：** 工厂端数据分析面板：月交易量、居间人转化率（接单数/浏览数）、平均响应时间、TOP10畅销产品、竞标响应率、已锁定佣金总额、已结算佣金总额、违约保证金收入。

| 类型 | 文件路径 | 状态 |
|------|---------|:----:|
| 前端页面 | 无（需新建 `fc_dashboard.vue`） | 未开发 |
| 后端控制器 | 无（需新建 `FcDashboard.php`） | 未开发 |
| 数据库表 | 需从 `fa_jj_order`、`fa_jj_commission` 等表聚合查询 | 可复用 |

**已完成：**
- 无

**未完成：**
- 核心KPI卡片（月交易量/转化率/响应时间）
- 畅销产品TOP10图表
- 竞标响应率统计
- 财务统计（锁定佣金/已结算/违约保证金）
- 后端聚合查询接口

**进度：0%**

---

### 10. 积分与心愿

**需求描述：** 工厂端积分系统，完成订单获积分（1000积分=100元），可兑换等值物品。

| 类型 | 文件路径 | 状态 |
|------|---------|:----:|
| 前端页面 | 无（需新建 `fc_points.vue`） | 未开发 |
| 后端控制器 | 无（需新建 `FcPoints.php`） | 未开发 |
| 数据库表 | 无（需新建 `fa_jj_factory_points` 或复用 `fa_jj_wish_goal` 扩展） | 未开发 |

**已完成：**
- 无

**未完成：**
- 积分余额与记录页面
- 积分兑换功能
- 后端积分CRUD接口
- 数据库表设计

**进度：0%**

---

### 11. 移动工作台

**需求描述：** 工厂移动端首页，展示待确认订单提醒、待锁定佣金提醒、快速产品状态切换、产品浏览与转化率、风险预警推送（24h佣金未锁定、合同未上传）。

| 类型 | 文件路径 | 状态 |
|------|---------|:----:|
| 前端页面 | 无（需新建 `fc_main.vue`、`fc_home.vue`） | 未开发 |
| 后端控制器 | 无（需新建 `FcDashboard.php` 或扩展） | 未开发 |

**已完成：**
- `jj_start.vue` 中存在工厂角色入口（roleType=2），但跳转后无工厂端页面

**未完成：**
- 工厂端主页Tab容器
- 待办事项提醒
- 快速产品状态切换
- 风险预警推送
- 后端工作台数据接口

**进度：0%**

---

### 12. 站内即时通讯（IM）

**需求描述：** 基于订单ID的聊天室，支持文字、图片，消息已读回执，全量日志留存用于纠纷举证。

| 类型 | 文件路径 | 状态 |
|------|---------|:----:|
| 前端 | 无 | 未开发 |
| 后端 | 无 | 未开发 |

**说明：** 与居间人端共用IM模块，需第三方SDK集成（融云/环信/腾讯IM）。

**进度：0%**

---

### 13. 消息通知与推送

**需求描述：** 订单状态变更通知、竞标邀请通知、佣金锁定提醒、风险预警推送。

| 类型 | 文件路径 | 状态 |
|------|---------|:----:|
| 前端 | 无 | 未开发 |
| 后端 | 无 | 未开发 |

**进度：0%**

---

## 三、可复用资源

工厂端虽然自身页面和接口均未开发，但以下已有资源可直接复用：

| 资源 | 说明 |
|------|------|
| `fa_jj_factory` 表 + `Factory.php` Model | 工厂基础信息，含状态字段 |
| `fa_jj_product` 表 + `Product.php` Model | 产品信息，含上下架状态 |
| `fa_jj_order` 表 + `Order.php` Model | 订单主表，9状态机完整定义 |
| `fa_jj_bid` / `fa_jj_bid_quote` 表 | 竞标和报价记录 |
| `fa_jj_deposit` / `fa_jj_contract` / `fa_jj_logistics` 表 | 保证金/合同/物流 |
| `fa_jj_commission` 表 | 佣金记录 |
| `fa_jj_order_log` 表 | 订单状态变更日志 |
| `fa_jj_agent_profile` 表 | 居间人评分数据（筛选用） |
| 居间人端 `JjOrder.php` / `JjBid.php` 等控制器 | 接口设计模式可参考 |
| `jj_start.vue` 角色选择页 | 已有工厂入口（roleType=2） |

---

## 四、后端文件清单（需新建）

| 文件 | 方法 | 对应功能 |
|------|------|---------|
| `FcFactory.php` | submit_cert / cert_status | 企业认证 |
| `FcProduct.php` | index / add / edit / del / on_shelf / off_shelf | 产品管理 |
| `FcOrder.php` | index / detail / confirm / lock_commission / review_contract / confirm_shipment / release_payment | 订单全流程 |
| `FcBid.php` | invitation_list / detail / submit_quote / update_quote | 竞标报价 |
| `FcAgent.php` | list / detail | 居间人筛选 |
| `FcDashboard.php` | overview / product_stats / finance_stats | 数据看板 |
| `FcPoints.php` | balance / history / exchange | 积分管理 |

---

## 五、前端页面清单（需新建）

| 页面 | 文件路径（建议） | 功能 |
|------|----------------|------|
| 工厂主页 | `pages/fc/fc_main/fc_main.vue` | Tab容器（首页/产品/订单/我的） |
| 首页工作台 | `pages/fc/fc_home/fc_home.vue` | 待办提醒、KPI摘要 |
| 企业认证 | `pages/fc/fc_auth/fc_auth.vue` | 资质上传 |
| 产品列表 | `pages/fc/fc_products/fc_products.vue` | 产品管理 |
| 产品编辑 | `pages/fc/fc_product_edit/fc_product_edit.vue` | 新增/编辑产品 |
| 订单列表 | `pages/fc/fc_orders/fc_orders.vue` | 按状态筛选 |
| 订单详情 | `pages/fc/fc_order_detail/fc_order_detail.vue` | 操作按钮集合 |
| 竞标列表 | `pages/fc/fc_bids/fc_bids.vue` | 竞标邀请列表 |
| 报价提交 | `pages/fc/fc_bid_quote/fc_bid_quote.vue` | 报价表单 |
| 居间人列表 | `pages/fc/fc_agents/fc_agents.vue` | 居间人筛选 |
| 数据看板 | `pages/fc/fc_dashboard/fc_dashboard.vue` | 统计图表 |
| 积分中心 | `pages/fc/fc_points/fc_points.vue` | 积分余额与兑换 |
| 个人中心 | `pages/fc/fc_profile/fc_profile.vue` | 工厂信息与设置 |

---

## 六、待开发功能优先级建议

### P0 — 最小可用产品（MVP）

| 功能 | 说明 |
|------|------|
| 工厂主页 + 角色跳转 | `jj_start.vue` roleType=2 跳转到工厂主页 |
| 企业认证 | 工厂入驻的前提条件 |
| 产品上架管理 | 核心功能：没有产品则居间人无法接单 |
| 订单确认 + 佣金锁定 | 交易闭环的工厂侧操作 |
| 发货管理 | 履约执行的关键节点 |

### P1 — 交易闭环完善

| 功能 | 说明 |
|------|------|
| 竞标报价 | 居间人已有竞标发布功能，工厂端报价是配对功能 |
| 合同审核 | 合同流程的工厂侧操作 |
| 同意放款 | 结算的最后触发点 |

### P2 — 体验增强

| 功能 | 说明 |
|------|------|
| 居间人筛选 | 工厂主动选择居间人 |
| 数据看板 | 运营分析 |
| 积分与心愿 | 激励体系 |
| IM + 消息推送 | 沟通与通知 |

---

## 七、总结

工厂端当前**整体完成度约 2%**，仅有角色选择入口和可复用的数据库表/Model，尚未开发任何独立的工厂端前端页面和后端API控制器。

需新建 **7个后端控制器**、**13个前端页面**，新增路由注册到 `pages.json`。

好消息是居间人端已完成的 17 张数据库表和 16 个 Model 可直接复用，工厂端主要是在同一套数据表上构建"另一侧视角"的操作界面。工厂端的开发模式可参考居间人端已有的控制器设计和前端组件风格，保持一致的技术栈和UI规范。
